list = [1,2,3,4,5]
printList list

Pg map { &double, list, new_list }

printList new_list

!
@double ... Nil => val, Nil => res_addr
    'val * 2 => 'res_addr
    Ret

@triple ... Nil => val, Nil => res_addr
    'val * 3 => 'res_addr
    Ret

@map ... Nil => f, Nil => list_addr, Nil => r
    head = 'list_addr
    Pg list_empty { 'r }

    P { 'head == 0 } Ret |

    L { 'head, 'Nil, P { 'pi /= 0 } => pi } l1
        val = '('pi + 1)
        Pg ['f] { val, new_val }
        Pg list_add { 'new_val, 'r }
    @l1 ...
    Ret

@list_empty ... Nil => targetAddr
    0 => 'targetAddr
    Ret

@list_add ... Nil => val, Nil => listAddr
    h = 'listAddr
    P { 'h == 0 } then | else
    @then ...
        curAddr = h;
        end
    @else ...
        L { 'h, 'Nil, P { ''j /= 0 } => j } l1
        @l1 ...
        curAddr = 'j;
        end
    @end ...
        nextNode = alloc 2;
        nextNode => curAddr
        'val => nextNode + 1
    Ret